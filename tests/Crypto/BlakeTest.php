<?php namespace Decred\Tests\Crypto;

use PHPUnit\Framework\TestCase;

function blake256 ($string) {
    return \Decred\Crypto\Hash::blake($string);
}

class BlakeTest extends TestCase
{
    public function test_blake256()
    {
        $this->assertEquals('716f6e863f744b9ac22c97ec7b76ea5f5908bc5b2f67c61510bfc4751384ea7a', blake256(''));
        $this->assertEquals('0a332a295575cc2170894b4fd606f2ef145a292de41724a61a5c91614f0e7bd0', blake256("\x60"));
        $this->assertEquals('ae873b56e3dfe3ab133bfd1f7cace238a7398994c882044b57d0896d123f2ebe', blake256("\xfd\xa2"));
        $this->assertEquals('7146f02e6adea9c634b0cf365df235585c41bbbbfd2acb0233fd7ebe80e13a12', blake256("\x44\x17\x66\x9f"));
        $this->assertEquals('55fff13a73af487c043be583a00e9debd542d403136b5cd5c086a356885f538d', blake256("\x11\x3e\x7f\x90\xa7\x2c\x73\x39"));
        $this->assertEquals('7e35cfaa6c3882d7790b06c17785adfd13c2d7d34ad60a182febcc5a5234cff1', blake256("\x0e\xee\x7b\x86\xce\x55\x54\xfa\x15\x88\xba\x3f\x58\xd7\x0a\x60"));
        $this->assertEquals('6bfbb875f182a2f9ce65c54eabebab4804a3fd5ab2b0649c5d9376b32361c25a', blake256("\xd5\xcb\xa3\x5a\x1c\x6c\x05\x05\x63\xc2\x51\x7a\xdf\xe1\x35\x2f\x76\x61\xb6\x56\xe8\x86\x1b\x09\x3b\xc7\x73\x29\xc8\xab\x42\x19"));
        $this->assertEquals('e299dc492fc9d50e76afe7207bd1a84eeaa2722a3493def8e8180b92bdb8c9f3', blake256("\x02\x27\x98\xfd\x4d\x32\x72\xed\x79\xa1\x29\x7e\x5d\xb6\x45\xc9\xec\xb9\x82\x6e\x1b\x4b\x91\x8d\xf9\x4c\xce\xf9\x32\xf4\x0f\x0d\xf1\x14\x78\x80\x41\x9c\x52\x5b\xd2\x4d\x6f\x35\xf4\x79\xcf\xc8\x80\x62\x68\x27\x7d\x18\x5a\xaf\xab\x7f\xf5\x2d\xf0\x77\xb2\x92"));
        $this->assertEquals('d3ac742166af246be73e98500e9b707a83971d4761d9f348093dbcbd44986305', blake256("\x29\x4a\xea\xcc\x73\x24\x48\x2f\xf5\x43\x6b\x5e\x53\x87\x95\x13\xc6\xe5\xa8\x91\xf3\xf9\x49\xcb\x35\xf0\x8b\x14\x73\xef\xdd\x7a\x0e\xf2\x6f\x39\x6b\xb2\x01\xa2\x8d\x86\x2e\xda\x8f\xb6\x92\x05\xcd\x67\xf4\xc7\xc9\x8c\x5e\x76\xb1\x3e\xa4\xa6\xec\x96\xfc\xe8\xd7\x60\xa1\x5c\x7a\x25\xbf\xbc\xc0\xb2\x6a\x0e\x0d\x0a\xc9\x8f\x5f\xa9\x34\xca\x38\x5b\xf2\xc2\xbc\xca\x90\xfd\xe6\x4d\x06\x64\x58\x3d\x77\x63\x4a\x04\x33\xb9\x94\x92\x02\x07\xf7\x44\xac\x2a\x69\x5e\x3a\x8b\xc3\x9e\x68\x01\xa7\x22\x9d\xb9\xb1\x1b\xd0\x75"));
        $this->assertEquals('b69fb4ee1dd4d571bb27200ce91d867f8c741b71947e08780a2336b1988b7879', blake256("\x09\x41\x6f\x25\xdc\x67\x7c\x93\x10\xde\x9b\x73\x8e\x37\x05\x9d\x0e\xb1\xe3\xf2\xee\xb6\x50\xb7\x0c\x70\x28\x6f\x87\xc7\xbb\x1f\x2d\x09\xbc\x84\x83\xbd\x30\xb3\x9b\x94\x9a\x9b\x4f\x0f\xce\x85\x39\xf6\x8f\x74\x37\x09\x65\xa4\x80\x05\x29\x23\x86\xad\x06\xb3\x53\xc5\x39\xee\x2e\x04\x31\xc9\x37\xc7\xd1\xec\x5b\xec\x61\xe4\x6a\x18\xb0\xa9\xcb\xdd\x12\x9d\x7d\x12\x61\xcf\x11\x5d\xd8\xb9\x60\x28\x47\xf9\x65\x14\xb5\x0e\xd0\xff\x07\x50\x9d\xeb\x29\x54\xff\x7c\xa5\x4c\xd7\xf8\x87\xd9\xaf\xb8\x1f\xe8\x09\x82\x42\xa2\x98\x24\x72\x54\x12\x93\x56\xb9\x01\x81\x7c\xe9\x96\xea\xdc\x79\x89\xf8\xcd\x2a\x06\x07\x1d\x40\x9b\xa3\xd0\x46\x6d\xb4\xdc\xd8\x9a\x95\x58\x66\x06\x5b\x74\x1a\x17\x13\x38\x7a\xfb\x52\xe5\x2f\xea\x97\x7c\xcc\xa6\x40\x7e\x77\x3b\x39\xe7\x89\x61\xdc\x9d\x08\x85\x43\x42\x9f\x05\x87\x1e\x63\x43\xd4\x21\xf9\x4b\x24\xea\x0d\x85\xe8\xe5\x8d\x2f\xa1\xc7\xd4\x1f\x87\xb5\xf8\xc9\xe8\xb3\xfc\x1d\x27\x7d\x15\xff\x58\xda\xc0\x3c\x10\x13\x7a\x26\xd8\x73\xe4\x82\x1c\xaa\xa8\x26\xbc\x85\xb4\xc4\x5e\xb3\x3d\xfb\x8a\x2c\xfa"));
        $this->assertEquals('66a31ff7f1df74038496ce1667bc62afaf7b485971aa8a317d91599429e6a907', blake256("\x73\xfb\x13\xbe\xf3\x2d\x30\xcd\x6a\xb2\x6d\xf1\x3c\x56\xbe\xa3\x75\x2f\x34\x65\xd4\x30\xcc\xda\x4c\x0b\x4b\xc2\xd3\x46\xc7\x3f\x29\xa3\xbb\x38\xff\x21\x0a\xc3\xe3\x01\xda\x8f\x56\x1a\x4b\xdc\x1e\xe6\x15\xfb\xb8\x40\xd0\xc1\x44\x0f\x03\xd1\xbf\x22\xb2\x5b\x40\x58\x9d\x4e\x24\x41\xbb\xea\xfb\x44\xdd\x9c\x82\x8a\x03\x29\xb2\x93\xf7\xcd\x67\x76\xb7\x2c\xb5\x76\xd0\x0a\xd1\x31\x19\x95\x1c\x71\xe8\xf6\xdb\x82\x02\xe0\xca\x51\x29\x5f\x7d\xe8\x0d\x50\x0c\xd9\xb6\xb8\x97\x85\x90\x5c\xbe\xa9\x21\x47\x8f\xeb\xf6\xf9\x4e\x4d\x47\x5f\x16\x93\x09\x71\x8b\x2d\xf2\x9e\x6d\x11\x08\xdb\x2a\x95\xa5\x93\xe0\x6e\xb4\xf8\xd2\x20\x2e\x57\xe7\xbc\x5f\xfa\x37\x44\x92\x2a\x8b\x25\xfe\xc1\x88\x6a\x66\xee\xfa\xed\x1a\x14\x8b\xdb\x06\x85\x19\xfe\xa7\x41\x46\x45\x43\xec\x8e\x9b\xe5\x28\x91\x7e\x06\x9e\x6e\xe1\x9f\x21\xa2\x31\x52\x1d\xd5\x00\xb4\xa4\x1b\x1f\x46\xd6\x6b\xdd\x71\x28\x86\x78\xa8\x86\x7d\x95\xa5\x5a\x05\x63\x1f\x6f\x73\x08\x86\x0c\x88\xcd\xeb\x49\x50\x57\x61\xce\x0b\x1a\x0d\xa6\xc3\x5a\x74\x6d\xc7\x57\x92\x15\x9b\x6a\xd9\x36\x99\x7a\xcb\x28\x2d\x08\xc9\x03\x18\xbb\xe7\x21\xbb\xff\x64\xa9\x6e\x73\xe5\x7d\xa6\x58\x4d\xb1\xef\x75\x58\x62\x99\x5e\xe8\x12\xdc\x4c\x84\x60\xa4\x99\x33\xd3\x73\xb0\xd0\xd9\x61\xd6\x2c\x2f\xfe\xd9\xb5\x77\xb9\xf2\xbe\x54\x1a\xb6\x1b\xfd\x1e\xd1\xd0\x7c\x83\xd7\xcc\x7e\x6f\xfa\x8d\x13\x6b\x36\x90\xfa\x63\x62\x34\x97\x68\xd6\x05\xac\x47\x95\x79\x4e\x4e\x60\x95\x16\x77\xe2\xaa\xe0\xce\x29\x0f\xa7\x7e\x88\x6b\xba\x44\x5f\xb6\xda\xb2\xa2\x2d\xfe\xb6\x46\xed\xd4\x69\xe8\x5e\x41\x23\xc1\x99\xe6\x03\x61\x5a\x8f\xf4\x47\x6c\xca\xd4\xcb\x35\x59\x7c\xbf\xde\x80\x32\xcf\xc9\x05\x0a\x36\x6e\x46\x0f\x5d\xdb\x45\x10\xbc\x04\x37\xb2\x04\xa0\x8f\x56\x56\xf3\xc5\x71\x31\x67\xf5\x37\xfa\x98\x37\x59\x42\xf9\x72\xe7\xec\xfd\x1f\xf5\x16\x95\x5d\x3f\x00\xeb\x92\xaf\xa3\x87\x47\xd5\x25\xdd\x46\xc8\x45\x54\x8a\x56\x4e\xdc\xd8\xa4\x6d\xc8\x56\xeb\xad\xcf\x9c\x1e\x0c\x3f\x29\x8b\x01\xe5\xed\xab\x3e\x47\x8a\xd5\xe7\xcd\xe1\xba\x8f\xf3\x58\x6d\x49\xff\x7b\x4a\xc0\x2c\x3f\x05\x07\x33\x9c\x7d\x8f\x78\x73\x7c\x7a\xbc\xb3\xbf\xa5\xc8\x10"));
        $this->assertEquals('6a94a9e7c35d232a4cd9fee70abb654c3591c97dc75bc40c6de5e4d6af71d7b8', blake256("\x0e\xef\x0f\x40\x8f\xdd\xd0\xa7\xb5\x96\xc4\x57\xf1\x1b\x7e\xf8\xeb\x19\x6e\x42\x66\xad\xa7\x9f\x9c\x7c\x69\x30\x47\xd7\x13\xbf\x1c\x01\x29\x22\x52\x13\x20\xae\x40\x84\x09\x15\xe7\x37\x06\xa9\xe6\x2a\x92\x9f\x01\x80\x9c\xc1\x17\xdd\x21\x82\x93\xc0\xf5\x7c\x41\x65\x74\x68\x2a\x57\xdf\x4a\xac\x89\xd5\x9e\xe5\x51\xbf\x3a\xde\xb6\x6f\x22\x86\xee\x60\x9c\x19\x54\xd3\x85\x1f\x73\xf9\xfe\xf2\xe0\x16\x89\xf9\xa6\x4e\xff\x52\x65\xf3\x6b\x6f\x87\x2e\x02\x97\x7b\x96\x64\x07\xc3\x5a\xe5\x95\x99\x22\x54\x43\x0b\xba\xa0\xb9\x4e\xc4\xfb\xc3\x12\x94\xe6\x4c\x4b\x14\x14\x7d\x92\x00\x2b\x28\xef\x47\x65\xb3\x2d\x6e\xb1\x40\xe1\x49\x15\xcb\xa8\x03\x5b\xf0\x6f\xdf\x29\x42\xf6\x5e\x69\x18\xc9\x83\xad\xb4\xec\x5b\x8a\x31\xb9\x17\x8f\xfa\xfe\xb7\x0a\xed\x43\xef\xf4\xef\x19\x43\xad\x99\x17\x31\xfa\x88\x1f\xb3\xcb\xe5\x39\xb1\x83\x58\x98\x18\x71\x3b\x0b\xd4\xc0\x75\xdb\xbd\xc1\x01\x56\x68\xdb\x6e\xce\xd6\x54\xc1\x55\x0c\xb4\xc2\x66\xff\xb8\x4c\xd5\x92\x4e\x07\x69\x77\x61\x74\xfc\xca\x1d\xf4\x8f\x5e\xf2\x52\xff\xf8\x54\x0e\x70\x08\xe3\x31\x1b\x54\x91\xf0\x06\x82\x3a\x9a\x7d\x42\x11\x22\x8b\x08\x93\x6d\xaf\xcc\x58\xbd\x62\x63\xc9\x60\x41\xab\x22\x1a\x0a\x52\xfe\x87\xf1\x4f\x52\x62\x9d\x9e\x98\x21\x48\x87\xd1\xcf\xcb\x8e\xd9\x18\x5b\xeb\xc5\x43\xf6\x0e\x88\xc1\xad\xc2\xaf\x74\x38\xfa\x60\x68\xed\xb5\x92\x8c\xb1\x58\xee\xd4\xc1\x9f\xb4\x4b\x50\x1b\x2b\x02\x0c\x5d\xf6\xde\x09\x1f\xf9\x30\xcf\x2f\x04\xd2\x7d\x93\x5b\x2f\x37\x44\x31\x60\xe8\x6d\x4e\xe0\x46\x44\x18\x4b\x34\xb0\xe5\x76\x3e\xcd\x81\x45\x45\x82\x27\xe6\x69\x47\x81\x25\x24\x02\xa0\xbd\x57\x15\x63\x5a\x69\x91\xaf\x2c\x58\x1f\x99\xfb\xa1\xcb\x8a\xe7\x1c\x27\xb0\x1b\xd6\x9b\x65\x8b\x01\x2e\xd0\xe6\xf9\x8d\x05\x56\x42\x36\x93\xb9\x65\x89\x9d\xfb\x24\xe4\xf0\xd0\xd4\xfe\x8f\x8b\xf8\xef\x7c\x3d\x7e\xee\x03\xa8\x25\x3e\x63\xdf\x7a\xf2\x6a\x6c\x19\x7c\x42\xbc\x11\x5c\x0e\xd3\xb3\x08\xb2\x52\x0a\xe5\x35\xf7\x25\x3a\xb0\x0c\x2e\xde\x9a\x11\x9a\xe4\x4a\x68\x7e\xc6\xf6\xc0\x6e\xd7\x9d\x6a\x99\xff\x9c\x9f\x4d\x80\x8c\x15\x7b\xb7\x68\x3c\x40\x16\x1a\xfd\xdb\xb9\x6b\x98\x2b\x5c\xa4\x62\xf0\x72\xa4\xf5\x5d\xfe\xe3\xd2\x25\x54\x0e\xbd\xaf\x13\xdb\x7a\xc0\x5c\x40\x85\x4c\xa6\xc6\x11\x8a\x65\x71\x10\xca\x8e\x19\xfa\x2e\xc7\xb3\xbc\x64\x89\x0a\xa5\xd6\x9e\x95\xa1\x29\x1d\x57\xdb\xdf\xb3\x51\xb1\xc8\xc6\xbd\x48\xe1\xda\xc7\x85\xda\xdc\xd3\xe0\xf8\xb2\x55\x49\xc4\x90\x3f\xbf\xf4\x0c\x9d\x52\x3e\x43\xd9\x28\xe5\xc1\x55\xce\x9c\x25\xfd\x5c\x56\xdd\xf2\x71\xe8\xde\x2e\xfc\x02\x73\x3d\x6c\x20\x14\x4c\x31\xd4\x3b\x37\xc3\x12\x46\x12\xbd\x85\xda\x4b\x87\x14\x2d\x8e\xe6\x58\xf5\xe1\x80\xc7\x96\x95\xd1\x18\xf3\xe7\xa2\xb6\x3f\xb5\x63\x3f\x53\x42\xb9\x33\x52\x82\x78\xf2\x2d\xdb\x90\xb1\x21\xe3\x8a\x08\x99\x37\x2b\x94\x6c\x8f\xf2\x7a\xb2\x54\x5c\x7e\x34\x16\x51\xdf\xfd\xb5\x03\x04\xdd\x94\x8b\xf8\xcb\x08\xbc\xa2\xee\xc5\x93\xde\xf3\x7e\x0b\x94\x87\xf7\x85\x15\x1b\xb1\xbc\xcc\x08\x74\x15\x9e\x04\xd6\x35\x76\xaa\xf3\xf7\x91\x1e\x71\x57\x60\x34\x67\xd5\xfe\x4c\x31\x40\x8c\xbb\x7a\x91\xbd\x86\x28\x9a\x75\x2c\x52\xf3\x14\xab\xfc\xe4\x6b\x42\x54\xac\xbb\x04\x21\xc9\x15\xa9\x86\x2c\x60\xc4\xeb\x1b\xfc\xd2\x9f\xcf\xa3\xa7\xc6\x7b\x2a\x32\x9d\xf1\xeb\x66\xdf\x84\x88\xfb\x0e\x79\xc6\xfb\x97\x71\x1e\x34\x7c\x39\xc4\x60\x45\xe3\x63\x3c\xe0\x6a\x4b\x7e\x76\xaf\xd8\x8b\xe4\x8c\x3c\x79\x8e\xa6\x10\xb2\xfa\x87\xe0\x22\x23\x45\xa2\x05\x6a\xb6\x9c\x9e\xda\x63\xcc\x6f\xe5\x22\xe6\xcf\x1c\xb6\xc7\xfa\x4c\x95\xc3\x4d\xb3\x59\xf8\x22\xe3\xdf\x52\x5b\x3c\xb1\xb9\xdd\xbb\x29\x2b\xa6\xdb\x75\xa7\xd3\x47\x48\x59\xb0\xa1\xdc\x7e\x6c\x2a\xec\xac\xaa\xb9\x98\xb9\xf0\x67\x96\x72\x64\xc2\x97\x00\xe6\x0a\xff\xd7\x5e\x80\xb6\xc1\x45\x9b\x63\x0b\x33\x8e\x17\x0e\x9a\x8e\xdd\x4a\xc0\x05\xce\xde\xca\xfe\x71\x6d\xe7\xb4\x54\x77\x1a\x8f\xa0\x5a\x10\xf4\x03\x16\x9a\xfc\xc9\x1b\x92\xae\xf0\x72\x98\x3c\xa6\x49\xfb\x99\xc9\x94\xce\x1a\x1b\x84\xea\x30\xaf\x4e\xe4\x7a\x11\x36\x4a\x52\x79\xcc\xa6\xb0\x0a\xcb\x90\x6c\x2f\x5a\x19\xd0\x0a\xed\x2b\x18\x15\xf0\xaf\x64\x46\x36\x5e\x3e\xb6\x03\x3c\x54\x59\x89\x8f\xe6\xc7\x53\x5c\x8e\x26\x09\xc1\x27\xa0\x8a\xb7\x1b\xa3\xbe\x6d\xa9\xf3\x69\x5d\x59\x42\x6e\xed\x16\xeb\xfa\x30\xeb\xbe\x0e\x8f\xb2\xb5\x65\xd1\x17\xe8\x16\x4c\xcb"));

        $this->assertEquals('f340221598d6e02b2f0b8a5b908a90e7a746138301cc702a52107f436fdf4108', blake256(file_get_contents(__DIR__.'/../fixtures/file311bytes.txt')));
        $this->assertEquals('f498fd2f70a781e2be53a7838369074f931134ff2db0633b0c857ec71330ac66', blake256(file_get_contents(__DIR__.'/../fixtures/file313bytes.txt')));
    }
}
